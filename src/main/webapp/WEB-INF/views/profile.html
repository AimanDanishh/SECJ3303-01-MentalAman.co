<div th:fragment="content(user)">
  <div class="p-8 space-y-6">

    <!-- Page Header -->
    <div>
      <h1 class="text-3xl font-bold text-slate-900 mb-2">Profile Settings</h1>
      <p class="text-slate-600">Manage your personal information</p>
    </div>

    <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">

      <!-- ================= LEFT COLUMN ================= -->
      <div class="lg:col-span-1 space-y-6">

        <!-- Profile Overview -->
        <div class="bg-white p-6 rounded-lg shadow text-center">
          <div
            class="w-32 h-32 rounded-full bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center mx-auto mb-4">
            <span class="text-white text-5xl">ðŸ‘¤</span>
          </div>
          <h2 class="text-2xl font-bold text-slate-900 mb-1"
              th:text="${user.name}">Demo Student</h2>
          <p class="text-slate-600 text-sm"
             th:text="${user.email}">student@demo.com</p>
          <p class="text-slate-500 text-sm mt-1"
             th:text="${user.role}">STUDENT</p>
        </div>

        <!-- BMI Summary -->
        <div class="bg-white p-6 rounded-lg shadow">
          <h3 class="text-xl font-semibold mb-4">Health Summary</h3>
          <p><strong>BMI:</strong> <span th:text="${user.bmi}">-</span></p>
          <p><strong>Category:</strong> <span th:text="${user.category}">-</span></p>
          <p><strong>Age:</strong> <span th:text="${user.age}">-</span></p>
        </div>
      </div>

      <!-- ================= RIGHT COLUMN ================= -->
      <div class="lg:col-span-2 space-y-6">

        <!-- Personal Info -->
        <div class="bg-white p-6 rounded-lg shadow">
          <h3 class="text-xl font-semibold mb-4">Personal Information</h3>

          <form th:action="@{/profile/update}"
                th:object="${user}"
                method="post"
                class="grid grid-cols-1 md:grid-cols-2 gap-4"
                id="profileForm">

            <!-- Name -->
            <div>
              <label class="block text-sm font-medium mb-1">Full Name</label>
              <p id="nameLabel" th:text="${user.name}" class="py-2"></p>
              <input id="nameInput" th:field="*{name}"
                     class="hidden w-full border px-4 py-2 rounded-lg"/>
            </div>

            <!-- Email (READ ONLY) -->
            <div>
              <label class="block text-sm font-medium mb-1">Email</label>
              <p th:text="${user.email}" class="py-2"></p>
            </div>

            <!-- Year of Birth -->
            <div>
              <label class="block text-sm font-medium mb-1">Year of Birth</label>
              <p id="yobLabel" th:text="${user.yob}" class="py-2"></p>
              <input id="yobInput" type="number" th:field="*{yob}"
                     class="hidden w-full border px-4 py-2 rounded-lg"/>
            </div>

            <!-- Weight -->
            <div>
              <label class="block text-sm font-medium mb-1">Weight (kg)</label>
              <p id="weightLabel" th:text="${user.weight}" class="py-2"></p>
              <input id="weightInput" type="number" step="0.1"
                     th:field="*{weight}"
                     class="hidden w-full border px-4 py-2 rounded-lg"/>
            </div>

            <!-- Height -->
            <div>
              <label class="block text-sm font-medium mb-1">Height (m)</label>
              <p id="heightLabel" th:text="${user.height}" class="py-2"></p>
              <input id="heightInput" type="number" step="0.01"
                     th:field="*{height}"
                     class="hidden w-full border px-4 py-2 rounded-lg"/>
            </div>

            <!-- Buttons -->
            <div class="md:col-span-2 flex gap-2 mt-4">
              <button type="button" id="editBtn"
                      class="px-4 py-2 bg-blue-600 text-white rounded-lg">
                Edit
              </button>

              <button type="submit" id="saveBtn"
                      class="hidden px-4 py-2 bg-green-600 text-white rounded-lg">
                Save
              </button>

              <button type="button" id="cancelBtn"
                      class="hidden px-4 py-2 border rounded-lg">
                Cancel
              </button>
            </div>

          </form>
        </div>
      </div>
    </div>
  </div>

  <!-- ================= JS ================= -->
  <script>
    const fields = ['name','yob','weight','height'];
    const editBtn = document.getElementById('editBtn');
    const saveBtn = document.getElementById('saveBtn');
    const cancelBtn = document.getElementById('cancelBtn');

    editBtn.onclick = () => {
      fields.forEach(f => {
        document.getElementById(f + 'Label').classList.add('hidden');
        document.getElementById(f + 'Input').classList.remove('hidden');
      });
      editBtn.classList.add('hidden');
      saveBtn.classList.remove('hidden');
      cancelBtn.classList.remove('hidden');
    };

    cancelBtn.onclick = () => location.reload();
  </script>
</div>
